<div class="question-container" id="question-{{ include.id }}">
    <h3 id="label-{{ include.id }}">Question: {{ include.title }}</h3>
    
    <div class="question-content">
        {{ include.question_text | markdownify }}
    </div>

    <!-- 
      ACCESSIBILITY NOTE: 
      We give the wrapper a role of 'group' or 'img' and a label so screen readers 
      know this is a diagram, not just random inputs.
    -->
    <div id="table-container-{{ include.id }}" class="venn-wrapper" role="group" aria-label="Venn Diagram for {{ include.label_a }} and {{ include.label_b }}">
        
        <!-- Left Circle Decoration -->
        <div class="venn-circle venn-left">
            <div class="venn-label" aria-hidden="true">{{ include.label_a }}</div>
        </div>

        <!-- Right Circle Decoration -->
        <div class="venn-circle venn-right">
            <div class="venn-label" aria-hidden="true">{{ include.label_b }}</div>
        </div>

        <!-- ZONE 1: A ONLY -->
        <div class="venn-zone zone-a-only">
            {% if include.val_a == 'INPUT' %}
                <input type="number" step="any" aria-label="Value for {{ include.label_a }} only">
            {% else %}
                <span class="venn-value" aria-label="{{ include.label_a }} only: {{ include.val_a }}">{{ include.val_a }}</span>
            {% endif %}
        </div>

        <!-- ZONE 2: INTERSECTION -->
        <div class="venn-zone zone-intersect">
            {% if include.val_mid == 'INPUT' %}
                <input type="number" step="any" aria-label="Intersection of {{ include.label_a }} and {{ include.label_b }}">
            {% else %}
                <span class="venn-value" aria-label="Intersection: {{ include.val_mid }}">{{ include.val_mid }}</span>
            {% endif %}
        </div>

        <!-- ZONE 3: B ONLY -->
        <div class="venn-zone zone-b-only">
            {% if include.val_b == 'INPUT' %}
                <input type="number" step="any" aria-label="Value for {{ include.label_b }} only">
            {% else %}
                <span class="venn-value" aria-label="{{ include.label_b }} only: {{ include.val_b }}">{{ include.val_b }}</span>
            {% endif %}
        </div>

        <!-- ZONE 4: OUTSIDE -->
        <div class="venn-zone zone-outside">
            {% if include.val_out == 'INPUT' %}
                <input type="number" step="any" aria-label="Value outside both circles">
            {% else %}
                <span class="venn-value" aria-label="Outside value: {{ include.val_out }}">{{ include.val_out }}</span>
            {% endif %}
        </div>

    </div>

    <!-- Buttons -->
    <div style="margin-top: 15px;">
        <!-- Check Answers reuses the table logic -->
        <button class="btn" onclick="checkTableFill('{{ include.id }}', '{{ include.answers }}', '{{ include.tolerance | default: 0 }}')">Check Answers</button>
        
        {% if include.solution_text %}
            <button 
                class="btn btn-primary solution-toggle-button" 
                id="btn-sol-{{ include.id }}"
                aria-expanded="false" 
                aria-controls="solution-{{ include.id }}" 
                onclick="toggleSolution('solution-{{ include.id }}', this)">
                Show Solution
            </button>
        {% endif %}
    </div>

    <!-- Live Feedback -->
    <div id="feedback-{{ include.id }}" aria-live="polite" class="feedback"></div>
    
    {% if include.solution_text %}
        <div id="solution-{{ include.id }}" class="solution-content" style="display:none;">
            <h4>Solution:</h4>
            {{ include.solution_text | markdownify }}
        </div>
    {% endif %}
</div>
